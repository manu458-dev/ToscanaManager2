# User Story US-12: Central Product Catalog Management

## User Story Description

**ID:** US-12

**Priority:** High

**User Story:**
As a **General Director**, I want to **manage the product catalog centrally (create, update, logical delete)** so that **product information is consistent and traceable across all branches**.

---

## Detailed Conversation

### Context
The Toscana Manager 2.0 system requires centralized product catalog management to ensure consistency across all 12 restaurant branches. The General Director needs to maintain a single source of truth for all menu items, products, and offerings. This ensures that product descriptions, pricing, and categorization are standardized while still allowing branches to indicate local availability based on their inventory and operational capacity.

### User Needs
**General Director:** "I need complete control over our product catalog. When we add a new menu item or change a price, it should be updated centrally so all branches see the same information. This prevents confusion and ensures brand consistency across all our locations."

**System Analyst:** "What does 'managing the product catalog' involve?"

**General Director:** "I need to be able to:
- **Create** new products with all their details
- **Update** existing products when recipes change, prices adjust, or descriptions improve
- **Remove** products that we're discontinuing - but not delete them completely because we need historical records
- Organize products into categories for easier navigation
- Set pricing that applies across all branches
- Manage product variations and modifiers"

**System Analyst:** "What information needs to be captured for each product?"

**General Director:** "Each product should have:
- **Basic Info:** Product name, description, SKU/product code
- **Category:** Appetizers, Main Courses, Desserts, Beverages, etc.
- **Pricing:** Base price (before tax)
- **Tax Category:** Different tax rates might apply to food vs. beverages
- **Modifiers:** Optional add-ons or customizations (extra cheese, dressing on side, etc.)
- **Allergen Information:** For customer safety
- **Nutritional Data:** Calories, if available
- **Image:** Product photo for digital menus
- **Status:** Active, Inactive, Seasonal
- **Preparation Time:** Helps with kitchen planning"

**System Analyst:** "You mentioned 'logical delete' rather than actually deleting products. Why?"

**General Director:** "If we physically delete a product from the database, we lose all historical data about it. We might have thousands of past transactions that reference that product. Instead, we should mark products as inactive or discontinued. This way:
- Historical sales reports still show the product
- We can see what we used to sell
- If we bring back a product, we can reactivate it instead of creating a duplicate
- Audit trails remain intact"

**System Analyst:** "How do branches fit into this? Can they modify products?"

**General Director:** "No, branches cannot modify product information - only I can. However, branches should be able to:
- Mark products as 'available' or 'unavailable' at their location
- Set temporary unavailability (like '86ing' an item that's out of stock)
- See which products are in the catalog

This way, I control the master data, but branches control local availability."

**Branch Manager:** "From my perspective, I need to see the full product catalog, but I should be able to indicate which items my location offers. Not every branch has the same menu - some locations might not have pizza ovens, for example."

**System Analyst:** "How should product pricing work if branches have different costs or local market conditions?"

**General Director:** "This is a good question. Our standard approach should be:
- I set the base price centrally
- Normally all branches use the same price
- In exceptional cases, I might allow branch-specific pricing overrides
- But this should be the exception, not the rule, to maintain brand consistency

For now, let's keep it simple: one price for all branches."

**System Analyst:** "What about product modifiers or customizations?"

**General Director:** "Modifiers are part of the product catalog I manage. For example, for 'Caesar Salad' I might define modifiers like:
- Add Chicken (+$4.00)
- Add Shrimp (+$6.00)
- Dressing on Side (+$0.00)
- No Croutons (+$0.00)

These modifiers apply to all branches. When branches take orders, customers can select from these predefined modifiers."

**System Analyst:** "How do you handle seasonal products?"

**General Director:** "I should be able to mark products as seasonal and define when they're active. For example:
- 'Pumpkin Ravioli' might be active September-November
- 'Summer Salad' might be active May-August

The system should automatically activate and deactivate these based on the date, while I can override manually if needed."

**System Analyst:** "Should there be any approval workflow for product changes?"

**General Director:** "For most changes, I don't need approval - I'm the ultimate authority. However, it might be helpful to have a 'draft' mode where I can prepare changes before publishing them. For example:
- I'm creating next month's new items
- I save them as drafts
- When I'm ready, I publish them all at once
- Branches see the updates immediately upon publish"

**System Analyst:** "What about product images?"

**General Director:** "Yes, professional product photos are important, especially for digital menus or tablets at tables. I should be able to:
- Upload photos for each product
- Crop or adjust them within the system
- Set multiple images if needed (different angles)
- Mark one as the primary image

If no image is uploaded, the system should use a default placeholder."

**System Analyst:** "How should products be organized or categorized?"

**General Director:** "I need a hierarchical category structure:
- Main categories: Appetizers, Main Courses, Desserts, Beverages
- Subcategories: Under Beverages → Soft Drinks, Beer, Wine, Coffee
- Products sit within the most specific category

This helps with menu organization and makes it easier for staff and customers to find items."

**System Analyst:** "What reporting do you need about the product catalog?"

**General Director:** "I should be able to see:
- Which products are most/least popular across all branches
- Products that haven't sold in X days (candidates for removal)
- Pricing history for each product
- When products were added, modified, or deactivated
- Which products are available at which branches"

**System Analyst:** "How should product codes or SKUs work?"

**General Director:** "Each product needs a unique identifier - a product code or SKU. The system could auto-generate these or let me define them. For example:
- APP-001 for Appetizer #1
- MC-015 for Main Course #15

Once assigned, the SKU should never change even if the product name changes."

### Business Value
- **Brand Consistency:** Ensures all branches present products uniformly
- **Efficiency:** Single point of product management rather than 12 separate catalogs
- **Accuracy:** Reduces errors from duplicate or outdated product information
- **Traceability:** Complete history of product changes and pricing
- **Flexibility:** Easy to add new products or update existing ones across all branches
- **Data Integrity:** Logical deletes preserve historical transaction data

---

## Acceptance Criteria (Gherkin Style)

### Scenario 1: Create New Product in Catalog
```gherkin
Feature: Central Product Catalog Management
  As a General Director
  I want to manage the product catalog centrally
  So that product information is consistent and traceable across all branches

Scenario: Successfully create a new menu item
  Given I am logged in as the General Director
  And I have permission to manage the product catalog
  When I navigate to "Product Catalog"
  And I click "Add New Product"
  And I enter the following details:
    | Field                | Value                                    |
    | Product Name         | Margherita Pizza                         |
    | SKU                  | MC-001                                   |
    | Description          | Classic tomato, mozzarella, basil       |
    | Category             | Main Courses > Pizza                     |
    | Base Price           | $14.00                                   |
    | Tax Category         | Food (8% rate)                           |
    | Preparation Time     | 15 minutes                               |
    | Allergen Info        | Contains: Dairy, Gluten                  |
    | Status               | Active                                   |
  And I upload a product image
  And I click "Save Product"
  Then the system should create the product with unique ID
  And the product should be immediately available in all 12 branches' catalogs
  And the product should appear in the "Main Courses > Pizza" category
  And the creation should be logged with timestamp and my user ID
  And I should see confirmation "Product 'Margherita Pizza' created successfully"
```

### Scenario 2: Update Existing Product Information
```gherkin
Scenario: Update product price and description
  Given I am logged in as the General Director
  And product "Margherita Pizza" (SKU: MC-001) exists with:
    | Field       | Current Value                      |
    | Price       | $14.00                             |
    | Description | Classic tomato, mozzarella, basil |
  When I navigate to the product catalog
  And I select product "MC-001"
  And I click "Edit Product"
  And I change the price to "$15.00"
  And I update the description to "Classic tomato sauce, fresh mozzarella, basil"
  And I save the changes
  Then the product should be updated with new values
  And all branches should see the updated price of $15.00
  And the old price should be preserved in price history
  And the update should be logged:
    | Field          | Old Value  | New Value  | Changed By        | Date       |
    | Price          | $14.00     | $15.00     | [My User ID]      | 2026-02-02 |
    | Description    | [Old text] | [New text] | [My User ID]      | 2026-02-02 |
```

### Scenario 3: Logical Delete (Deactivate) Product
```gherkin
Scenario: Discontinue a product without deleting historical data
  Given I am logged in as the General Director
  And product "Old Style Lasagna" (SKU: MC-025) exists and is active
  And this product has been sold 500 times historically
  And I want to remove it from the menu
  When I navigate to the product catalog
  And I select product "MC-025"
  And I click "Deactivate Product"
  And I enter reason "Recipe discontinued - replaced with new version"
  And I confirm the deactivation
  Then the product status should change to "Inactive"
  And the product should no longer appear on active menus at any branch
  And the product should no longer be orderable
  And all 500 historical sales records should remain intact
  And the product should still appear in historical reports
  And I should be able to reactivate it later if needed
  And the deactivation should be logged with reason and timestamp
```

### Scenario 4: Prevent Physical Deletion of Products
```gherkin
Scenario: System prevents permanent deletion of products
  Given I am logged in as the General Director
  And product "Caesar Salad" exists in the catalog
  And the product has historical sales data
  When I view the product details
  Then I should NOT see a "Delete" option
  And I should only see options to:
    | Available Action    |
    | Edit Product        |
    | Deactivate Product  |
    | View History        |
  And the system should not allow physical deletion through any interface
  And even inactive products should remain in the database permanently
```

### Scenario 5: Add Product Modifiers
```gherkin
Scenario: Define customization options for a product
  Given I am logged in as the General Director
  And product "Caesar Salad" (SKU: APP-010) exists
  When I edit the product
  And I add the following modifiers:
    | Modifier Name      | Price Change | Type      |
    | Add Chicken        | +$4.00       | Optional  |
    | Add Shrimp         | +$6.00       | Optional  |
    | Dressing on Side   | $0.00        | Optional  |
    | No Croutons        | $0.00        | Optional  |
    | Extra Dressing     | +$1.00       | Optional  |
  And I save the modifiers
  Then all modifiers should be associated with "Caesar Salad"
  And when staff at any branch add "Caesar Salad" to an order, they should see these modifier options
  And the modifier prices should automatically adjust the item total
  And modifiers should appear on receipts and bills
```

### Scenario 6: Organize Products into Categories
```gherkin
Scenario: Assign product to hierarchical category structure
  Given I am logged in as the General Director
  And the following category hierarchy exists:
    """
    Beverages
      ├── Soft Drinks
      ├── Beer
      ├── Wine
      └── Coffee & Tea
    """
  And I am creating a new product "Espresso"
  When I select the category during product creation
  Then I should see the hierarchical structure
  And I should be able to select "Beverages > Coffee & Tea"
  And when the product is saved, it should be categorized correctly
  And branch staff should be able to browse products by this category
  And reports should be able to group sales by category
```

### Scenario 7: Create Seasonal Product with Active Dates
```gherkin
Scenario: Define seasonal product with automatic activation period
  Given I am logged in as the General Director
  When I create a new product "Pumpkin Ravioli"
  And I mark it as "Seasonal"
  And I set the active period:
    | Field        | Value        |
    | Active From  | September 1  |
    | Active Until | November 30  |
  And I save the product
  Then the product should be created as "Seasonal"
  And when the current date is within Sep 1 - Nov 30, the product should be available
  And when the current date is outside this range, the product should be automatically unavailable
  And I should be able to manually override the automatic scheduling if needed
  And the seasonal status should be visible to all branches
```

### Scenario 8: View Product Change History
```gherkin
Scenario: Review complete audit trail of product modifications
  Given I am logged in as the General Director
  And product "Margherita Pizza" has been modified multiple times:
    | Date       | Change Type  | Field Changed | Old Value | New Value | Changed By     |
    | 2025-12-01 | Created      | -             | -         | -         | GD Admin       |
    | 2026-01-15 | Updated      | Price         | $14.00    | $14.50    | GD Admin       |
    | 2026-02-01 | Updated      | Price         | $14.50    | $15.00    | GD Admin       |
    | 2026-02-02 | Updated      | Description   | [Old]     | [New]     | GD Admin       |
  When I navigate to the product
  And I click "View History"
  Then I should see all changes in chronological order
  And each entry should show what changed, who made the change, and when
  And I should be able to see the complete evolution of the product
```

### Scenario 9: Branch Marks Product as Locally Unavailable
```gherkin
Scenario: Branch indicates a product is out of stock at their location
  Given product "Lobster Ravioli" (SKU: MC-030) exists and is active in the catalog
  And I am logged in as a Branch Manager for branch "BR-005"
  When I view the product catalog for my branch
  And I select "Lobster Ravioli"
  And I click "Mark as Unavailable"
  And I enter reason "Out of stock - awaiting delivery"
  And I save the availability status
  Then "Lobster Ravioli" should be marked unavailable only at branch "BR-005"
  And staff at "BR-005" should see it's unavailable when taking orders
  And other branches should still see it as available
  And the product information itself should remain unchanged in the central catalog
  And the General Director should be able to see which branches have marked it unavailable
```

### Scenario 10: Prevent Duplicate Product SKUs
```gherkin
Scenario: System prevents creating products with duplicate SKU codes
  Given I am logged in as the General Director
  And product "Margherita Pizza" exists with SKU "MC-001"
  When I attempt to create a new product
  And I enter SKU "MC-001" (already taken)
  And I attempt to save
  Then the system should display error "SKU 'MC-001' is already in use by 'Margherita Pizza'"
  And prevent product creation
  And suggest the next available SKU: "MC-032"
  And allow me to either:
    | Option                        |
    | Use suggested SKU             |
    | Enter a different unique SKU  |
    | Cancel product creation       |
```

---
